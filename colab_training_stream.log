[09:27:19] [START] üöÄ Starting Streaming Colab GPU Training...
[09:27:19] [INFO] Training started at: 2025-11-02 09:27:19
[09:27:19] [CONFIG] Device: cuda
[09:27:19] [CONFIG] GPU: Tesla T4
[09:27:19] [CONFIG] GPU Memory: 15.8 GB
[09:27:19] [INFO] Seed set to 42 for reproducibility
[09:27:19] [LOAD] üì¶ Loading model and tokenizer...
[09:27:21] [INFO] ‚úÖ Tokenizer loaded: google/electra-small-discriminator
[09:27:21] [LOAD] üìä Loading SQuAD dataset...
[09:27:26] [INFO] ‚úÖ Dataset loaded - Training: 10000, Validation: 1000
[09:27:26] [PROCESS] üîÑ Preprocessing datasets...
[09:27:32] [INFO] ‚úÖ Preprocessing completed in 5.5s
[09:27:32] [CONFIG] üîß Creating training configuration...
[09:27:32] [INFO] ‚úÖ Training arguments configured
[09:27:32] [INFO] ‚úÖ Data collator created
[09:27:32] [INFO] 
============================================================
[09:27:32] [STAGE] üéØ BASELINE MODEL TRAINING STARTED
[09:27:32] [INFO] ============================================================
[09:27:34] [INFO] ‚úÖ Baseline trainer initialized
[09:27:34] [INFO] ‚ñ∂Ô∏è  Starting baseline training...
[09:29:30] [DEBUG] compute_metrics called with 1000 predictions
[09:29:30] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:29:30] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:29:31] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:29:31] [DEBUG] compute_metrics result: {'exact_match': 34.0, 'f1': 42.80211509759493}
[09:31:27] [DEBUG] compute_metrics called with 1000 predictions
[09:31:27] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:31:27] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:31:28] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:31:28] [DEBUG] compute_metrics result: {'exact_match': 49.7, 'f1': 59.20533316421837}
[09:33:24] [DEBUG] compute_metrics called with 1000 predictions
[09:33:24] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:33:24] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:33:24] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:33:24] [DEBUG] compute_metrics result: {'exact_match': 52.2, 'f1': 61.2558456986396}
[09:33:25] [EVAL] üìä Evaluating baseline model...
[09:33:32] [DEBUG] compute_metrics called with 1000 predictions
[09:33:32] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:33:32] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:33:33] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:33:33] [DEBUG] compute_metrics result: {'exact_match': 52.2, 'f1': 61.2558456986396}
[09:33:33] [INFO] ‚úÖ Baseline training completed in 350.3s
[09:33:33] [METRIC] üìä Baseline EM: 52.2000
[09:33:33] [METRIC] üìä Baseline F1: 61.2558
[09:33:33] [DEBUG] 
üîç Available metrics in baseline_results:
[09:33:33] [DEBUG]   eval_exact_match: 52.2
[09:33:33] [DEBUG]   eval_f1: 61.2558456986396
[09:33:33] [DEBUG]   epoch: 3.0
[09:33:33] [INFO] 
============================================================
[09:33:33] [STAGE] üó∫Ô∏è  CARTOGRAPHY-MITIGATED MODEL TRAINING
[09:33:33] [INFO] ============================================================
[09:33:33] [INFO] ‚úÖ Found cartography weights at: /content/nlp-fa25-final-project/results/cartography/training_weights_upweight_hard.json
[09:33:33] [INFO] ‚úÖ Loaded cartography weights (1000 examples)
[09:33:33] [INFO] ‚úÖ Cartography trainer initialized
[09:33:33] [INFO] ‚ñ∂Ô∏è  Starting cartography training...
[09:35:36] [DEBUG] compute_metrics called with 1000 predictions
[09:35:36] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:35:36] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:35:37] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:35:37] [DEBUG] compute_metrics result: {'exact_match': 34.1, 'f1': 43.589262643923455}
[09:37:32] [DEBUG] compute_metrics called with 1000 predictions
[09:37:32] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:37:32] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:37:33] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:37:33] [DEBUG] compute_metrics result: {'exact_match': 54.2, 'f1': 63.626535264937445}
[09:39:28] [DEBUG] compute_metrics called with 1000 predictions
[09:39:28] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:39:28] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:39:29] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:39:29] [DEBUG] compute_metrics result: {'exact_match': 57.1, 'f1': 66.34065602628719}
[09:39:29] [EVAL] üìä Evaluating cartography model...
[09:39:37] [DEBUG] compute_metrics called with 1000 predictions
[09:39:37] [DEBUG]   First prediction: {'id': '56be4db0acb8001400a502ec', 'prediction_text': 'Denver Broncos'}
[09:39:37] [DEBUG]   First reference: {'id': '56be4db0acb8001400a502ec', 'answers': {'text': ['Denver Broncos', 'Denver Broncos', 'Denver Broncos'], 'answer_start': [177, 177, 177]}}
[09:39:38] [DEBUG] compute_metrics result keys: ['exact_match', 'f1']
[09:39:38] [DEBUG] compute_metrics result: {'exact_match': 57.1, 'f1': 66.34065602628719}
[09:39:38] [INFO] ‚úÖ Cartography training completed in 356.0s
[09:39:38] [METRIC] üìä Cartography EM: 57.1000
[09:39:38] [METRIC] üìä Cartography F1: 66.3407
[09:39:38] [INFO] 
============================================================
[09:39:38] [SUMMARY] üìä FINAL RESULTS SUMMARY
[09:39:38] [INFO] ============================================================
[09:39:38] [INFO] Baseline EM:      52.2000
[09:39:38] [INFO] Baseline F1:      61.2558
[09:39:38] [INFO] Cartography EM:   57.1000
[09:39:38] [INFO] Cartography F1:   66.3407
[09:39:38] [INFO] EM Improvement:   +4.9000
[09:39:38] [INFO] F1 Improvement:   +5.0848
[09:39:38] [INFO] 
‚è±Ô∏è  Total training time: 12.3 minutes
[09:39:38] [INFO] 
‚úÖ Training complete! Results saved.
[09:39:38] [INFO] üìÅ Log file: /content/colab_training_stream.log
[09:39:38] [INFO] üìä Results file: /content/colab_training_results.json
[09:39:38] [INFO] 
üì• Preparing files for download...
[09:39:38] [INFO] ‚úÖ Files ready for download!
[09:39:38] [INFO] 
üéâ Training pipeline complete!
